<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='warp_distance() is a low level engine for computing date time distances.
It returns the distance from x to the origin in units
defined by the period.
For example, period = "year" would return the number of years from
the origin. Setting every = 2 would return the number of 2 year groups
from the origin.'><title>Compute distances from a date time origin — warp_distance • warp</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute distances from a date time origin — warp_distance"><meta property="og:description" content='warp_distance() is a low level engine for computing date time distances.
It returns the distance from x to the origin in units
defined by the period.
For example, period = "year" would return the number of years from
the origin. Setting every = 2 would return the number of 2 year groups
from the origin.'><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">warp</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.2.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/hour.html">Hour Distances and Daylight Savings</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/DavisVaughan/warp/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Compute distances from a date time origin</h1>
      <small class="dont-index">Source: <a href="https://github.com/DavisVaughan/warp/blob/HEAD/R/distance.R" class="external-link"><code>R/distance.R</code></a></small>
      <div class="d-none name"><code>warp_distance.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>warp_distance()</code> is a low level engine for computing date time distances.</p>
<p>It returns the distance from <code>x</code> to the <code>origin</code> in units
defined by the <code>period</code>.</p>
<p>For example, <code>period = "year"</code> would return the number of years from
the <code>origin</code>. Setting <code>every = 2</code> would return the number of 2 year groups
from the <code>origin</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">warp_distance</span><span class="op">(</span><span class="va">x</span>, <span class="va">period</span>, <span class="va">...</span>, every <span class="op">=</span> <span class="fl">1L</span>, origin <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p><code>[Date / POSIXct / POSIXlt]</code></p>
<p>A date time vector.</p></dd>


<dt>period</dt>
<dd><p><code>[character(1)]</code></p>
<p>A string defining the period to group by. Valid inputs can be roughly
broken into:</p><ul><li><p><code>"year"</code>, <code>"quarter"</code>, <code>"month"</code>, <code>"week"</code>, <code>"day"</code></p></li>
<li><p><code>"hour"</code>, <code>"minute"</code>, <code>"second"</code>, <code>"millisecond"</code></p></li>
<li><p><code>"yweek"</code>, <code>"mweek"</code></p></li>
<li><p><code>"yday"</code>, <code>"mday"</code></p></li>
</ul></dd>


<dt>...</dt>
<dd><p><code>[dots]</code></p>
<p>These dots are for future extensions and must be empty.</p></dd>


<dt>every</dt>
<dd><p><code>[positive integer(1)]</code></p>
<p>The number of periods to group together.</p>
<p>For example, if the period was set to <code>"year"</code> with an every value of <code>2</code>,
then the years 1970 and 1971 would be placed in the same group.</p></dd>


<dt>origin</dt>
<dd><p><code>[Date(1) / POSIXct(1) / POSIXlt(1) / NULL]</code></p>
<p>The reference date time value. The default when left as <code>NULL</code> is the
epoch time of <code>1970-01-01 00:00:00</code>, <em>in the time zone of the index</em>.</p>
<p>This is generally used to define the anchor time to count from, which is
relevant when the every value is <code>&gt; 1</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A double vector containing the distances.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The return value of <code>warp_distance()</code> has a variety of uses. It can be used
for:</p><ul><li><p>A grouping column in a <code>dplyr::group_by()</code>. This is especially useful for
grouping by a multitude of a particular period, such as "every 5 months".</p></li>
<li><p>Computing distances between values in <code>x</code>, in units of the <code>period</code>.
By returning the distances from the <code>origin</code>, <code>warp_distance()</code> has also
implicitly computed the distances between values of <code>x</code>. This is used
by <code>slide::block()</code> to break the input into time blocks.</p></li>
</ul><p>When the time zone of <code>x</code> differs from the time zone of <code>origin</code>, a warning
is issued, and <code>x</code> is coerced to the time zone of <code>origin</code> without changing
the number of seconds of <code>x</code> from the epoch. In other words, the time zone
of <code>x</code> is directly changed to the time zone of <code>origin</code> without changing the
underlying numeric representation. <strong>It is highly advised to specify an
<code>origin</code> value with the same time zone as <code>x</code>.</strong> If a <code>Date</code> is used for
<code>x</code>, its time zone is assumed to be <code>"UTC"</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="period">Period<a class="anchor" aria-label="anchor" href="#period"></a></h2>
    


<p>For <code>period</code> values of <code>"year"</code>, <code>"month"</code>, and <code>"day"</code>, the information
provided in <code>origin</code> is truncated. Practically this means that if you
specify:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">warp_distance</span>(<span class="at">period =</span> <span class="st">"month"</span>, <span class="at">origin =</span> <span class="fu">as.Date</span>(<span class="st">"1970-01-15"</span>))</span></code></pre><p></p></div>
<p>then only <code>1970-01</code> will be used, and not the fact that the origin starts
on the 15th of the month.</p>
<p>The <code>period</code> value of <code>"quarter"</code> is internally
<code>period = "month", every = every * 3</code>. This means that for <code>"quarter"</code>
the month specified for the <code>origin</code> will be used as the month to start
counting from to generate the 3 month quarter.</p>
<p>To mimic the behavior of <code>lubridate::floor_date()</code>, use <code>period = "week"</code>.
Internally this is just <code>period = "day", every = every * 7</code>. To mimic the
<code>week_start</code> argument of <code>floor_date()</code>, set <code>origin</code> to a date
with a week day identical to the one you want the week to start from. For
example, the default origin of <code>1970-01-01</code> is a Thursday, so this would be
generate groups identical to <code>floor_date(week_start = 4)</code>.</p>
<p>The <code>period</code> value of <code>"yday"</code> is computed as complete <code>every</code>-day periods
from the <code>origin</code>, with a forced reset of the <code>every</code>-day counter every
time you hit the month-day value of the <code>origin</code>. <code>"yweek"</code> is built on top
of this internally as <code>period = "yday", every = every * 7</code>. This ends up
using an algorithm very similar to <code>lubridate::week()</code>, with the added
benefit of being able to control the <code>origin</code> date.</p>
<p>The <code>period</code> value of <code>"mday"</code> is computed as <code>every</code>-day periods within
each month, with a forced reset of the <code>every</code>-day counter
on the first day of each month. The most useful application of this is
<code>"mweek"</code>, which is implemented as <code>period = "mday", every = every * 7</code>. This
allows you to group by the "week of the month". For <code>"mday"</code> and <code>"mweek"</code>,
only the year and month parts of the <code>origin</code> value are used. Because of
this, the <code>origin</code> argument is not that interesting for these periods.</p>
<p>The <code>"hour"</code> period (and more granular frequencies) can produce results
that might be surprising, even if they are technically correct. See the
vignette at <code><a href="../articles/hour.html">vignette("hour", package = "warp")</a></code> for more information.</p>
    </div>
    <div class="section level2">
    <h2 id="precision">Precision<a class="anchor" aria-label="anchor" href="#precision"></a></h2>
    


<p>With <code>POSIXct</code>, the limit of precision is approximately the microsecond
level. Only dates that are very close to the unix origin of 1970-01-01 can
possibly represent microsecond resolution correctly (close being within
about 40 years on either side). Otherwise, the values past the microsecond
resolution are essentially random, and can cause problems for the distance
calculations. Because of this, decimal digits past the microsecond range are
zeroed out, so please do not attempt to rely on them. It should still be safe
to work with microseconds, by, say, bucketing them by millisecond distances.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"1970-01-01"</span><span class="op">)</span> <span class="op">+</span> <span class="op">-</span><span class="fl">4</span><span class="op">:</span><span class="fl">4</span></span></span>
<span class="r-in"><span><span class="va">x</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "1969-12-28" "1969-12-29" "1969-12-30" "1969-12-31" "1970-01-01"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6] "1970-01-02" "1970-01-03" "1970-01-04" "1970-01-05"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compute monthly distances (really, year + month)</span></span></span>
<span class="r-in"><span><span class="fu">warp_distance</span><span class="op">(</span><span class="va">x</span>, <span class="st">"month"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1 -1 -1 -1  0  0  0  0  0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compute distances every 2 days, relative to "1970-01-01"</span></span></span>
<span class="r-in"><span><span class="fu">warp_distance</span><span class="op">(</span><span class="va">x</span>, <span class="st">"day"</span>, every <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -2 -2 -1 -1  0  0  1  1  2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compute distances every 2 days, this time relative to "1970-01-02"</span></span></span>
<span class="r-in"><span><span class="fu">warp_distance</span><span class="op">(</span><span class="va">x</span>, <span class="st">"day"</span>, every <span class="op">=</span> <span class="fl">2</span>, origin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"1970-01-02"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -3 -2 -2 -1 -1  0  0  1  1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="st">"1970-01-01 00:00:01"</span>, <span class="st">"UTC"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compute distances every 5 seconds, starting from the unix epoch of</span></span></span>
<span class="r-in"><span><span class="co"># 1970-01-01 00:00:00</span></span></span>
<span class="r-in"><span><span class="co"># So this buckets:</span></span></span>
<span class="r-in"><span><span class="co"># [1970-01-01 00:00:00, 1970-01-01 00:00:05) = 0</span></span></span>
<span class="r-in"><span><span class="co"># [1970-01-01 00:00:05, 1970-01-01 00:00:10) = 1</span></span></span>
<span class="r-in"><span><span class="co"># [1970-01-01 00:00:10, 1970-01-01 00:00:15) = 2</span></span></span>
<span class="r-in"><span><span class="fu">warp_distance</span><span class="op">(</span><span class="va">y</span>, <span class="st">"second"</span>, every <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0 0 0 1 1 1 2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compute distances every 5 seconds, starting from the minimum of `x`</span></span></span>
<span class="r-in"><span><span class="co"># 1970-01-01 00:00:01</span></span></span>
<span class="r-in"><span><span class="co"># So this buckets:</span></span></span>
<span class="r-in"><span><span class="co"># [1970-01-01 00:00:01, 1970-01-01 00:00:06) = 0</span></span></span>
<span class="r-in"><span><span class="co"># [1970-01-01 00:00:06, 1970-01-01 00:00:11) = 1</span></span></span>
<span class="r-in"><span><span class="co"># [1970-01-01 00:00:11, 1970-01-01 00:00:16) = 2</span></span></span>
<span class="r-in"><span><span class="va">origin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="st">"1970-01-01 00:00:01"</span>, <span class="st">"UTC"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">warp_distance</span><span class="op">(</span><span class="va">y</span>, <span class="st">"second"</span>, every <span class="op">=</span> <span class="fl">5</span>, origin <span class="op">=</span> <span class="va">origin</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0 0 0 0 1 1 2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ---------------------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Time zones</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># When `x` is not UTC and `origin` is left as `NULL`, the origin is set as</span></span></span>
<span class="r-in"><span><span class="co"># 1970-01-01 00:00:00 in the time zone of `x`. This seems to be the most</span></span></span>
<span class="r-in"><span><span class="co"># practically useful default.</span></span></span>
<span class="r-in"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="st">"1969-12-31 23:00:00"</span>, <span class="st">"UTC"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">z_in_nyc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="st">"1969-12-31 23:00:00"</span>, <span class="st">"America/New_York"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Practically this means that these give the same result, because their</span></span></span>
<span class="r-in"><span><span class="co"># `origin` values are defined in their respective time zones.</span></span></span>
<span class="r-in"><span><span class="fu">warp_distance</span><span class="op">(</span><span class="va">z</span>, <span class="st">"year"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1</span>
<span class="r-in"><span><span class="fu">warp_distance</span><span class="op">(</span><span class="va">z_in_nyc</span>, <span class="st">"year"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare that to what would happen if we used a static `origin` of</span></span></span>
<span class="r-in"><span><span class="co"># 1970-01-01 00:00:00 UTC.</span></span></span>
<span class="r-in"><span><span class="co"># America/New_York is 5 hours behind UTC, so when `z_in_nyc` is converted to</span></span></span>
<span class="r-in"><span><span class="co"># UTC the value becomes `1970-01-01 04:00:00 UTC`, a different year. Because</span></span></span>
<span class="r-in"><span><span class="co"># this is generally surprising, a warning is thrown.</span></span></span>
<span class="r-in"><span><span class="va">origin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="st">"1970-01-01 00:00:00"</span>, tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">warp_distance</span><span class="op">(</span><span class="va">z</span>, <span class="st">"year"</span>, origin <span class="op">=</span> <span class="va">origin</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1</span>
<span class="r-in"><span><span class="fu">warp_distance</span><span class="op">(</span><span class="va">z_in_nyc</span>, <span class="st">"year"</span>, origin <span class="op">=</span> <span class="va">origin</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>`x` (America/New_York) and `origin` (UTC) do not have the same time zone. Converting `x` to the time zone of `origin`. It is highly advised to provide `x` and `origin` with the same time zone.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ---------------------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># `period = "yweek"`</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2019-12-23"</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0</span><span class="op">:</span><span class="fl">16</span></span></span>
<span class="r-in"><span><span class="va">origin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"1970-01-01"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># `"week"` counts the number of 7 day periods from the `origin`</span></span></span>
<span class="r-in"><span><span class="co"># `"yweek"` restarts the 7 day counter every time you hit the month-day</span></span></span>
<span class="r-in"><span><span class="co"># value of the `origin`. Notice how, for the `yweek` column, only 1 day was</span></span></span>
<span class="r-in"><span><span class="co"># in the week starting with `2019-12-31`. This is because the next day is</span></span></span>
<span class="r-in"><span><span class="co"># `2020-01-01`, which aligns with the month-day value of the `origin`.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="va">x</span>,</span></span>
<span class="r-in"><span>  week <span class="op">=</span> <span class="fu">warp_distance</span><span class="op">(</span><span class="va">x</span>, <span class="st">"week"</span>, origin <span class="op">=</span> <span class="va">origin</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  yweek <span class="op">=</span> <span class="fu">warp_distance</span><span class="op">(</span><span class="va">x</span>, <span class="st">"yweek"</span>, origin <span class="op">=</span> <span class="va">origin</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             x week yweek</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  2019-12-23 2607  2647</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  2019-12-24 2607  2648</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  2019-12-25 2607  2648</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  2019-12-26 2608  2648</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  2019-12-27 2608  2648</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  2019-12-28 2608  2648</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  2019-12-29 2608  2648</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  2019-12-30 2608  2648</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  2019-12-31 2608  2649</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 2020-01-01 2608  2650</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 2020-01-02 2609  2650</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 2020-01-03 2609  2650</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 2020-01-04 2609  2650</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 2020-01-05 2609  2650</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 2020-01-06 2609  2650</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 2020-01-07 2609  2650</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 2020-01-08 2609  2651</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ---------------------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># `period = "mweek"`</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2019-12-23"</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0</span><span class="op">:</span><span class="fl">16</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># `"mweek"` breaks `x` up into weeks of the month. Notice how days 1-7</span></span></span>
<span class="r-in"><span><span class="co"># of 2020-01 all have the same distance value. A forced reset of the 7 day</span></span></span>
<span class="r-in"><span><span class="co"># counter is done at the 1st of every month. This results in the 3 day</span></span></span>
<span class="r-in"><span><span class="co"># week of the month at the end of 2019-12, from 29-31.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="va">x</span>,</span></span>
<span class="r-in"><span>  mweek <span class="op">=</span> <span class="fu">warp_distance</span><span class="op">(</span><span class="va">x</span>, <span class="st">"mweek"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             x mweek</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  2019-12-23  2960</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  2019-12-24  2960</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  2019-12-25  2960</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  2019-12-26  2960</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  2019-12-27  2960</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  2019-12-28  2960</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  2019-12-29  2961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  2019-12-30  2961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  2019-12-31  2961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 2020-01-01  2962</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 2020-01-02  2962</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 2020-01-03  2962</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 2020-01-04  2962</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 2020-01-05  2962</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 2020-01-06  2962</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 2020-01-07  2962</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 2020-01-08  2963</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Davis Vaughan.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

