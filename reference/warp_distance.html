<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Compute distances from a date time origin — warp_distance • warp</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Compute distances from a date time origin — warp_distance" />
<meta property="og:description" content="warp_distance() is a low level engine for computing date time distances.
It returns the distance from x to the origin in units
defined by the period specified with by. For example, by = &quot;year&quot; would
return the number of years from the origin, which is the Unix epoch of
1970-01-01 00:00:00 UTC by default." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">warp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/DavisVaughan/warp">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute distances from a date time origin</h1>
    <small class="dont-index">Source: <a href='https://github.com/DavisVaughan/warp/blob/master/R/distance.R'><code>R/distance.R</code></a></small>
    <div class="hidden name"><code>warp_distance.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>warp_distance()</code> is a low level engine for computing date time distances.</p>
<p>It returns the distance from <code>x</code> to the <code>origin</code> in units
defined by the period specified with <code>by</code>. For example, <code>by = "year"</code> would
return the number of years from the <code>origin</code>, which is the Unix epoch of
<code>1970-01-01 00:00:00 UTC</code> by default.</p>
    </div>

    <pre class="usage"><span class='fu'>warp_distance</span>(<span class='no'>x</span>, <span class='kw'>by</span> <span class='kw'>=</span> <span class='st'>"year"</span>, <span class='kw'>every</span> <span class='kw'>=</span> <span class='fl'>1L</span>, <span class='kw'>origin</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p><code>[Date / POSIXct / POSIXlt]</code></p>
<p>The vector to compute time distances for.</p></td>
    </tr>
    <tr>
      <th>by</th>
      <td><p><code>[character(1)]</code></p>
<p>A string defining the period to group by. Valid inputs are:</p><ul>
<li><p><code>"year"</code></p></li>
<li><p><code>"quarter"</code></p></li>
<li><p><code>"month"</code></p></li>
<li><p><code>"week"</code></p></li>
<li><p><code>"day"</code></p></li>
<li><p><code>"hour"</code></p></li>
<li><p><code>"minute"</code></p></li>
<li><p><code>"second"</code></p></li>
</ul></td>
    </tr>
    <tr>
      <th>every</th>
      <td><p><code>[positive integer(1)]</code></p>
<p>The number of <code>by</code> periods to lump together when constructing the groups.
For example, with the default <code>origin</code> and <code>by = "year"</code>, <code>every = 2</code>
would put the years <code>1970</code> and <code>1971</code> in the same group.</p></td>
    </tr>
    <tr>
      <th>origin</th>
      <td><p><code>[Date(1) / POSIXct(1) / POSIXlt(1)]</code></p>
<p>The reference value for the distances to be computed from. This is
particularly important when <code>every &gt; 1</code> and you need to define when the
"first" event was to start counting from.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An integer vector containing the distances, unless <code>by = "second"</code>, in which
case a double vector is returned to avoid integer overflow.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The return value of <code>warp_distance()</code> is suitable for use as a grouping
column in, for example, a <code>dplyr::mutate()</code>. This is especially useful for
grouping by a multitude of a particular period, such as "every 5 months"
starting from your particular <code>origin</code> value. If you want "cleaner" grouping
values, you might consider running <code>vctrs::vec_group_id()</code> on the result from
<code>warp_distance()</code>.</p>
<p>When the time zone of <code>x</code> differs from the time zone of <code>origin</code>, a warning
is issued, and <code>x</code> is coerced to the time zone of <code>origin</code> without changing
the number of seconds of <code>x</code> from the epoch. In other words, the time zone
of <code>x</code> is directly changed to the time zone of <code>origin</code> without changing the
underlying numeric representation. <strong>It is highly advised to specify your own
<code>origin</code> value with the same time zone as <code>x</code>.</strong></p>
<p>If a <code>Date</code> is used for <code>x</code>, its time zone is assumed to be <code>"UTC"</code>.</p>
<p>The information in the provided <code>origin</code> is truncated by the <code>by</code> period
specified. This means that if you specify <code>by = "month"</code>,
<code>every = 2</code>, with an origin of <code>1970-01-15</code>, the only pieces of information
that are used are the year and the month, and not the fact that the origin
starts on the 15th of the month. The exceptions to this are <code>"week"</code> and
<code>"quarter"</code>, see below.</p>
<p>For <code>by = "week"</code>, a week is defined as a 7 day period starting
from the <code>origin</code>'s year-month-day value.</p>
<p>For <code>by = "quarter"</code>, a quarter is defined as a 3 month period starting
from the <code>origin</code>'s year-month value.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span>(<span class='st'>"1970-01-01"</span>) + -<span class='fl'>4</span>:<span class='fl'>4</span>
<span class='no'>x</span></div><div class='output co'>#&gt; [1] "1969-12-28" "1969-12-29" "1969-12-30" "1969-12-31" "1970-01-01"
#&gt; [6] "1970-01-02" "1970-01-03" "1970-01-04" "1970-01-05"</div><div class='input'>
<span class='co'># Compute monthly distances (really, year + month)</span>
<span class='fu'>warp_distance</span>(<span class='no'>x</span>, <span class='st'>"month"</span>)</div><div class='output co'>#&gt; [1] -1 -1 -1 -1  0  0  0  0  0</div><div class='input'>
<span class='co'># Compute distances every 2 days, relative to "1970-01-01"</span>
<span class='fu'>warp_distance</span>(<span class='no'>x</span>, <span class='st'>"day"</span>, <span class='kw'>every</span> <span class='kw'>=</span> <span class='fl'>2</span>)</div><div class='output co'>#&gt; [1] -2 -2 -1 -1  0  0  1  1  2</div><div class='input'>
<span class='co'># Compute distances every 2 days, this time relative to "1970-01-02"</span>
<span class='fu'>warp_distance</span>(<span class='no'>x</span>, <span class='st'>"day"</span>, <span class='kw'>every</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>origin</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span>(<span class='st'>"1970-01-02"</span>))</div><div class='output co'>#&gt; [1] -3 -2 -2 -1 -1  0  0  1  1</div><div class='input'>
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span>(<span class='st'>"1970-01-01 00:00:01"</span>, <span class='st'>"UTC"</span>) + <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>4</span>, <span class='fl'>5</span>, <span class='fl'>6</span>, <span class='fl'>10</span>)

<span class='co'># Compute distances every 5 seconds, starting from the unix epoch of</span>
<span class='co'># 1970-01-01 00:00:00</span>
<span class='co'># So this buckets:</span>
<span class='co'># [1970-01-01 00:00:00, 1970-01-01 00:00:05) = 0</span>
<span class='co'># [1970-01-01 00:00:05, 1970-01-01 00:00:10) = 1</span>
<span class='co'># [1970-01-01 00:00:10, 1970-01-01 00:00:15) = 2</span>
<span class='fu'>warp_distance</span>(<span class='no'>y</span>, <span class='st'>"second"</span>, <span class='kw'>every</span> <span class='kw'>=</span> <span class='fl'>5</span>)</div><div class='output co'>#&gt; [1] 0 0 0 1 1 1 2</div><div class='input'>
<span class='co'># Compute distances every 5 seconds, starting from the minimum of `x`</span>
<span class='co'># 1970-01-01 00:00:01</span>
<span class='co'># So this buckets:</span>
<span class='co'># [1970-01-01 00:00:01, 1970-01-01 00:00:06) = 0</span>
<span class='co'># [1970-01-01 00:00:06, 1970-01-01 00:00:11) = 1</span>
<span class='co'># [1970-01-01 00:00:11, 1970-01-01 00:00:16) = 2</span>
<span class='no'>origin</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span>(<span class='st'>"1970-01-01 00:00:01"</span>, <span class='st'>"UTC"</span>)
<span class='fu'>warp_distance</span>(<span class='no'>y</span>, <span class='st'>"second"</span>, <span class='kw'>every</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>origin</span> <span class='kw'>=</span> <span class='no'>origin</span>)</div><div class='output co'>#&gt; [1] 0 0 0 0 1 1 2</div><div class='input'>
<span class='co'># Differing time zones between `x` and `origin` can be particularly</span>
<span class='co'># problematic. For this reason, if the time zones are different a warning</span>
<span class='co'># is issued and `x` is coerced to the time zone of `origin`. The default</span>
<span class='co'># `origin` time zone for the epoch is UTC.</span>
<span class='no'>x_in_nyc</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span>(<span class='st'>"1970-01-01 01:00:00"</span>, <span class='st'>"America/New_York"</span>)

<span class='co'># The default origin is `1970-01-01 00:00:00 UTC`.</span>
<span class='co'># We passed in a clock time 1 hour after that, but in a different time zone.</span>
<span class='co'># America/New_York is 5 hours behind UTC, so when it is converted to</span>
<span class='co'># UTC the value becomes `1970-01-01 06:00:00 UTC`</span>
<span class='fu'>warp_distance</span>(<span class='no'>x_in_nyc</span>, <span class='st'>"hour"</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: `x` (America/New_York) and `origin` (UTC) do not have the same time zone. Converting `x` to the time zone of `origin`. It is highly advised to provide `x` and `origin` with the same time zone.</span></div><div class='output co'>#&gt; [1] 6</div><div class='input'>
<span class='co'># We can use an origin value in our own time zone to fix this</span>
<span class='co'># (it doesn't have to be 1970-01-01)</span>
<span class='no'>origin</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.POSIXlt.html'>as.POSIXct</a></span>(<span class='st'>"1970-01-01"</span>, <span class='st'>"America/New_York"</span>)
<span class='fu'>warp_distance</span>(<span class='no'>x_in_nyc</span>, <span class='st'>"hour"</span>, <span class='kw'>origin</span> <span class='kw'>=</span> <span class='no'>origin</span>)</div><div class='output co'>#&gt; [1] 1</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Davis Vaughan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


